#!/usr/bin/kano-splash /usr/share/linux-story/media/images/splash.png /usr/bin/env python

# linux-story-gui
#
# Copyright (C) 2014, 2015 Kano Computing Ltd
# License: GNU General Public License v2 http://www.gnu.org/licenses/gpl-2.0.txt
#
# Launches linux tutorial in a Gtk application

from gi.repository import Gtk
import os
import sys

if __name__ == '__main__' and __package__ is None:
    dir_path = os.path.abspath(os.path.join(os.path.dirname(__file__), '..'))
    if dir_path != '/usr':
        sys.path.insert(1, dir_path)

from linux_story.gtk3.MainWindow import MainWindow

# Track the user's progress
from kano_profile.tracker import Tracker
kanotracker = Tracker()


def main():
    win = MainWindow()

    # If the application is launched with two arguments, then this is
    # debugging and we want to launch the application directly from the level
    # specified
    if len(sys.argv) == 3:
        win.setup_application_widgets()
        win.create_terminal(sys.argv[1], sys.argv[2])

    else:
        # Show the selection menu for the unlocked challenges
        win.show_menu()

    os.system("kano-stop-splash")
    Gtk.main()


# close the server through here
def handle_cleanup():
    pass


if __name__ == "__main__":
    try:
        main()
    finally:
        handle_cleanup()
